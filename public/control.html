<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factoid Control Panel</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        button {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .hotkey-info {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .hotkey-info h3 {
            margin-top: 0;
            color: #00ff00;
        }

        .hotkey-item {
            margin: 8px 0;
            font-size: 13px;
        }

        .hotkey-combo {
            background: rgba(0, 0, 0, 0.3);
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
            color: #00ff00;
        }

        .status {
            text-align: center;
            margin-top: 15px;
            font-size: 12px;
            opacity: 0.8;
        }

        .game-selector {
            margin: 15px 0;
        }

        .game-selector label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: bold;
        }

        .game-selector select {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            cursor: pointer;
        }

        .game-selector select option {
            background: #2a2a2a;
            color: white;
        }

        .trigger-cue-section {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid rgba(0, 255, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .trigger-cue-section h3 {
            margin: 0 0 10px 0;
            color: #00ff00;
            font-size: 16px;
        }

        .trigger-cue {
            background: rgba(0, 0, 0, 0.3);
            color: #00ff00;
            font-size: 16px;
            font-weight: bold;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
            border: 1px solid rgba(0, 255, 0, 0.5);
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }

        .factoid-progress {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        @keyframes flash {
            0% { background: rgba(0, 0, 0, 0.3); }
            50% { background: rgba(0, 255, 0, 0.3); }
            100% { background: rgba(0, 0, 0, 0.3); }
        }

        .config-panel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .config-panel h3 {
            margin: 0 0 15px 0;
            color: #00ff00;
            text-align: center;
        }

        .config-section {
            margin-bottom: 20px;
        }

        .config-section h4 {
            margin: 0 0 10px 0;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .config-row {
            display: flex;
            align-items: center;
            margin: 8px 0;
            gap: 10px;
        }

        .config-row label {
            min-width: 120px;
            font-size: 12px;
        }

        .config-row input[type="color"] {
            width: 40px;
            height: 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .config-row input[type="range"] {
            flex: 1;
            max-width: 100px;
        }

        .config-row span {
            font-size: 11px;
            min-width: 50px;
            text-align: center;
        }

        .config-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .config-buttons button {
            padding: 8px 15px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Factoid Overlay Control</h1>
        
        <div class="control-panel">
            <div class="button-group">
                <button onclick="showFactoid()">Show Random Factoid</button>
                <button onclick="hideOverlay()">Hide Overlay</button>
                
                <div class="trigger-cue-section">
                    <h3>üì∫ Next Trigger Cue</h3>
                    <div id="triggerCue" class="trigger-cue">Ready for factoid</div>
                    <div id="factoidProgress" class="factoid-progress">Game: Auto-Detect | Factoid: 1/8</div>
                </div>
                
                <div class="game-selector">
                    <label for="gameSelect">Select Game:</label>
                    <select id="gameSelect" onchange="updateSelectedGame()">
                        <option value="default">Auto-Detect / General</option>
                        <option value="minecraft">Minecraft</option>
                        <option value="valorant">Valorant</option>
                        <option value="csgo">CS:GO</option>
                        <option value="cs2">Counter-Strike 2</option>
                        <option value="overwatch">Overwatch 2</option>
                        <option value="fortnite">Fortnite</option>
                        <option value="leagueoflegends">League of Legends</option>
                        <option value="dota2">Dota 2</option>
                        <option value="worldofwarcraft">World of Warcraft</option>
                        <option value="apex">Apex Legends</option>
                    </select>
                </div>
                
                <button onclick="showGameSpecificFactoid()">Show Game-Specific Factoid</button>
                <button onclick="resetFactoidOrder()">Reset Factoid Order</button>
                <button onclick="toggleClickThrough()" id="clickThroughBtn">Toggle Click-Through</button>
                <button onclick="openConfigPanel()">‚öôÔ∏è Configure Overlay</button>
            </div>

            <div id="configPanel" class="config-panel" style="display: none;">
                <h3>üé® Overlay Configuration</h3>
                
                <div class="config-section">
                    <h4>Colors</h4>
                    <div class="config-row">
                        <label for="bgColor">Background Color:</label>
                        <input type="color" id="bgColor" value="#000000">
                        <input type="range" id="bgOpacity" min="0" max="100" value="90">
                        <span>Opacity</span>
                    </div>
                    
                    <div class="config-row">
                        <label for="borderColor">Border Color:</label>
                        <input type="color" id="borderColor" value="#00ff00">
                    </div>
                    
                    <div class="config-row">
                        <label for="textColor">Text Color:</label>
                        <input type="color" id="textColor" value="#ffffff">
                    </div>
                    
                    <div class="config-row">
                        <label for="titleBgColor">Title Background:</label>
                        <input type="color" id="titleBgColor" value="#00ff00">
                    </div>
                    
                    <div class="config-row">
                        <label for="titleTextColor">Title Text Color:</label>
                        <input type="color" id="titleTextColor" value="#000000">
                    </div>
                </div>
                
                <div class="config-section">
                    <h4>Style</h4>
                    <div class="config-row">
                        <label for="borderRadius">Border Radius:</label>
                        <input type="range" id="borderRadius" min="0" max="30" value="15">
                        <span id="borderRadiusValue">15px</span>
                    </div>
                    
                    <div class="config-row">
                        <label for="fontSize">Font Size:</label>
                        <input type="range" id="fontSize" min="12" max="24" value="16">
                        <span id="fontSizeValue">16px</span>
                    </div>
                </div>
                
                <div class="config-buttons">
                    <button onclick="applyConfig()">Apply Changes</button>
                    <button onclick="resetConfig()">Reset to Default</button>
                    <button onclick="closeConfigPanel()">Close</button>
                </div>
            </div>

            <div class="hotkey-info">
                <h3>‚å®Ô∏è Global Hotkeys</h3>
                <div class="hotkey-item">
                    <span class="hotkey-combo">Ctrl + Shift + F</span> - Show random factoid
                </div>
                <div class="hotkey-item">
                    <span class="hotkey-combo">Ctrl + Shift + H</span> - Hide overlay
                </div>
            </div>

            <div class="status">
                Overlay server running on localhost:3000
            </div>
        </div>
    </div>

    <script>
        const { ipcRenderer } = require('electron');

        let selectedGame = 'default';

        function showFactoid() {
            ipcRenderer.send('show-factoid');
        }

        function hideOverlay() {
            ipcRenderer.send('hide-overlay');
        }

        function updateSelectedGame() {
            const select = document.getElementById('gameSelect');
            selectedGame = select.value;
        }

        function showGameSpecificFactoid() {
            ipcRenderer.send('show-game-factoid', selectedGame);
        }

        function resetFactoidOrder() {
            ipcRenderer.send('reset-factoid-order');
        }

        function toggleClickThrough() {
            ipcRenderer.send('toggle-click-through');
        }

        function openConfigPanel() {
            const panel = document.getElementById('configPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            
            // Load current configuration
            ipcRenderer.send('get-overlay-config');
        }

        function closeConfigPanel() {
            document.getElementById('configPanel').style.display = 'none';
        }

        function applyConfig() {
            const config = {
                backgroundColor: hexToRgba(document.getElementById('bgColor').value, document.getElementById('bgOpacity').value / 100),
                borderColor: document.getElementById('borderColor').value,
                textColor: document.getElementById('textColor').value,
                titleBackgroundColor: `linear-gradient(135deg, ${document.getElementById('titleBgColor').value}, ${document.getElementById('titleBgColor').value}dd)`,
                titleTextColor: document.getElementById('titleTextColor').value,
                borderRadius: document.getElementById('borderRadius').value + 'px',
                fontSize: document.getElementById('fontSize').value + 'px'
            };
            
            ipcRenderer.send('update-overlay-config', config);
        }

        function resetConfig() {
            document.getElementById('bgColor').value = '#000000';
            document.getElementById('bgOpacity').value = 90;
            document.getElementById('borderColor').value = '#00ff00';
            document.getElementById('textColor').value = '#ffffff';
            document.getElementById('titleBgColor').value = '#00ff00';
            document.getElementById('titleTextColor').value = '#000000';
            document.getElementById('borderRadius').value = 15;
            document.getElementById('fontSize').value = 16;
            
            updateSliderValues();
            applyConfig();
        }

        function hexToRgba(hex, alpha) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }

        function updateSliderValues() {
            document.getElementById('borderRadiusValue').textContent = document.getElementById('borderRadius').value + 'px';
            document.getElementById('fontSizeValue').textContent = document.getElementById('fontSize').value + 'px';
        }

        // Listen for trigger cue updates
        ipcRenderer.on('update-trigger-cue', (event, data) => {
            const triggerCueElement = document.getElementById('triggerCue');
            const progressElement = document.getElementById('factoidProgress');
            
            triggerCueElement.textContent = data.cue;
            progressElement.textContent = `Game: ${data.gameTitle} | Factoid: ${data.factoidNumber}/${data.totalFactoids}`;
            
            // Add a flash effect to draw attention
            triggerCueElement.style.animation = 'none';
            setTimeout(() => {
                triggerCueElement.style.animation = 'flash 0.5s ease-in-out';
            }, 10);
        });

        // Listen for click-through status updates
        ipcRenderer.on('click-through-status', (event, isClickThrough) => {
            const btn = document.getElementById('clickThroughBtn');
            btn.textContent = isClickThrough ? 'Disable Click-Through' : 'Enable Click-Through';
            btn.style.backgroundColor = isClickThrough ? 'rgba(255, 0, 0, 0.3)' : 'rgba(0, 255, 0, 0.3)';
        });

        // Listen for overlay configuration
        ipcRenderer.on('overlay-config', (event, config) => {
            // Update UI with current config
            const bgColor = config.backgroundColor.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);
            if (bgColor) {
                const hex = '#' + [bgColor[1], bgColor[2], bgColor[3]].map(x => {
                    const hex = parseInt(x).toString(16);
                    return hex.length === 1 ? '0' + hex : hex;
                }).join('');
                document.getElementById('bgColor').value = hex;
                document.getElementById('bgOpacity').value = Math.round((bgColor[4] || 1) * 100);
            }
            
            document.getElementById('borderColor').value = config.borderColor;
            document.getElementById('textColor').value = config.textColor;
            document.getElementById('titleTextColor').value = config.titleTextColor;
            document.getElementById('borderRadius').value = parseInt(config.borderRadius);
            document.getElementById('fontSize').value = parseInt(config.fontSize);
            
            updateSliderValues();
        });

        // Add some visual feedback
        document.addEventListener('DOMContentLoaded', () => {
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 100);
                });
            });

            // Add slider event listeners
            document.getElementById('borderRadius').addEventListener('input', updateSliderValues);
            document.getElementById('fontSize').addEventListener('input', updateSliderValues);
            
            // Initial values
            updateSliderValues();
        });
    </script>
</body>
</html>
